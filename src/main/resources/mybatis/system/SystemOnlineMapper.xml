<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="SystemOnlineMapper">

	<resultMap type="UserOnline" id="UserOnlineResult">
		<id     property="sessionId"         column="sessionId"         />
		<result property="userId"            column="user_id"           />
		<result property="loginName"         column="login_name"        />
		<result property="host"              column="ipaddr"            />
		<result property="browser"           column="browser"           />
		<result property="os"                column="os"                />
		<result property="status"            column="status"            />
		<result property="startTimestamp"    column="start_timestsamp"  />
		<result property="lastAccessTime"    column="last_access_time"  />
		<result property="timeout"           column="timeout"           />
		<association property="session" javaType="OnlineSession" resultMap="OnlineSessionResult" />
	</resultMap>
	
	<resultMap type="OnlineSession" id="OnlineSessionResult">
		<id     property="id"                column="sessionId"         />
		<result property="userId"            column="user_id"           />
		<result property="loginName"         column="login_name"        />
		<result property="host"              column="ipaddr"            />
		<result property="browser"           column="browser"           />
		<result property="os"                column="os"                />
		<result property="status"            column="status"            />
	</resultMap>
	
	<select id="selectByOnlineId" parameterType="String" resultMap="UserOnlineResult">
		SELECT  *
		FROM sys_user_online
		WHERE sessionId = #{sessionId}
	</select>

	<insert id="insertLogininfor" parameterType="UserOnline">
		replace into sys_user_online(sessionId, user_id, login_name, ipaddr, browser, os, STATUS) 
        values (#{sessionId}, #{user_id}, #{login_name}, #{host}, #{browser}, #{os}, #{STATUS})
	</insert>
	
 	<delete id="deleteByOnlineId" parameterType="String">
 		delete from sys_user_online where sessionId = #{sessionId}
 	</delete>

</mapper> 