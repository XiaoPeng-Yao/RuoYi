<!DOCTYPE html>
<html lang="zh" xmlns:th="http://www.thymeleaf.org">
<head>
    <th:block th:include="include :: header('新增交换机模板')"/>
</head>
<body class="white-bg">
<div class="wrapper wrapper-content animated fadeInRight ibox-content">
    <form class="form-horizontal m" id="form-tmplSwitch-add">
        <div class="form-group">
            <label class="col-sm-3 control-label">交换机品牌：</label>
            <div class="col-sm-8">
                <input id="switchBrand" name="switchBrand" class="form-control" type="text">
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-3 control-label">交换机型号：</label>
            <div class="col-sm-8">
                <input id="switchType" name="switchType" class="form-control" type="text">
            </div>
        </div>
        <div class="form-group">
            <label class="col-sm-3 control-label">交换机电源数量：</label>
            <div class="col-sm-8">
                <input id="powerNum" name="powerNum" class="form-control" type="text">
            </div>
        </div>

        <div class="form-group" th:with="type=${@dict.getType('dict_port_type')}">
            <div class="col-sm-6" th:each="dict : ${type}">
                <div class="col-md-12">
                    <div class="form-group">
                        <label class="col-sm-3 control-label" th:text="${dict.dictLabel}"></label>
                        <div class="col-sm-9">
                            <input type="text" value="" th:name="${dict.dictCode}" class="form-control switchPort"
                                   placeholder="单位(个)">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </form>
</div>
<div th:include="include::footer"></div>
<script type="text/javascript">
    var prefix = ctx + "template/tmplSwitch"
    $("#form-tmplSwitch-add").validate({
        onkeyup: false,
        rules: {
            switchBrand: {
                required: true,
                minlength: 2,
                maxlength: 20
            },
            switchType: {
                required: true,
                minlength: 2,
                maxlength: 20
            },
            powerNum: {
                required: true,
                minlength: 1,
                maxlength: 2
            },
        },
        focusCleanup: true
    });

    function submitHandler() {
        if ($.validate.form()) {
            var data = $('#form-tmplSwitch-add').serializeArray();
            var params = [];
            $(".switchPort").each(function () {
                params.push({"id": $(this).attr("name"), "value": $(this).val()});
            });
            var obj = {
                "name": "foreignKeyInfo",
                "value": JSON.stringify(params)
            };
            data.push(obj);
            $.operate.save(prefix + "/add", data);
        }
    }
</script>
</body>
</html>
